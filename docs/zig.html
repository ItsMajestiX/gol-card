<!DOCTYPE html> <html lang="en"><head>
<title>Zig</title>
<base href=".">
<meta name="pathname" content="zig.html">
<meta name="description" content="gol_card_docs - Zig">
<meta property="og:title" content="Zig">
<meta property="og:description" content="gol_card_docs - Zig">
<meta property="og:type" content="website">
<meta property="og:url" content="zig.html">
<meta property="og:image" content="undefined">
<meta charset="UTF-8"><meta property="og:site_name" content="gol_card_docs"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0"><script async="" id="webpage-script" src="site-lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-wasm-script" src="site-lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="site-lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="site-lib/media/favicon.png"><link rel="stylesheet" href="site-lib/styles/obsidian.css"><link rel="preload" href="site-lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="site-lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/main-styles.css"></noscript><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-vertical-spacing:1.3em;--sidebar-margin:12px}:root{background-color:#202124}.sidebar{height:100%;font-size:14px;z-index:10;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));position:relative;overflow:hidden;overflow:clip;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}#left-sidebar{left:0}#right-sidebar{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}.sidebar.floating{position:absolute}.sidebar .leaf-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .leaf-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}#left-sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}#right-sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar #left-sidebar-content,.sidebar #right-sidebar-content{contain:none!important;container-type:normal!important;animation:none!important}.sidebar:has(.leaf-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:calc(2.3em + 2 * var(--sidebar-margin));width:var(--sidebar-width);padding:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}#left-sidebar .sidebar-topbar{left:0;flex-direction:row;border-top-right-radius:var(--radius-l)}#right-sidebar .sidebar-topbar{right:0;flex-direction:row-reverse;border-top-left-radius:var(--radius-l)}#left-sidebar .topbar-content{margin-right:calc(2.3em + var(--sidebar-margin));flex-direction:row}#right-sidebar .topbar-content{margin-left:calc(2.3em + var(--sidebar-margin));flex-direction:row-reverse}.topbar-content{overflow:hidden visible;overflow:clip visible;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:2px!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}#left-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}#right-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.feature-title{margin-left:1px;text-transform:uppercase;letter-spacing:.06em;margin-top:.75em;margin-bottom:.75em}.feature-header{display:flex;align-items:center;padding-top:0;font-size:1em;padding-left:0}body.floating-sidebars .sidebar{position:absolute}body{transition:background-color var(--color-fade-speed) ease-in-out}#navbar:not(:empty){display:flex;align-items:center;justify-content:space-between;padding:.5em 1em;width:100%}#main{display:flex;flex-direction:column;height:100%;width:100%;align-items:stretch;justify-content:center}#main-horizontal{display:flex;flex-direction:row;flex-grow:1;width:100%;align-items:stretch;justify-content:center}#center-content{flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0!important;transition:opacity .2s ease-in-out;pointer-events:none}#center-content>.obsidian-document{padding-left:2em;padding-right:1em;margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}body #center-content>.obsidian-document>.markdown-preview-sizer{padding-bottom:80vh;width:100%;max-width:var(--line-width);flex-basis:var(--line-width);transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document>div{width:100%!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document:not([data-type=markdown]).embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}#center-content>.obsidian-document:not([data-type=markdown]).embed>*{max-width:100%;max-height:100%;object-fit:contain}:not(h1,h2,h3,h4,h5,h6,li):has(> :is(.math,table)){overflow-x:auto!important}#center-content>.obsidian-document:not([data-type=markdown]){overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.obsidian-document[data-type=attachment]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;width:100%}.obsidian-document[data-type=attachment]>*{outline:0;border:none;box-shadow:none}.obsidian-document[data-type=attachment] :is(img){max-width:90%;max-height:90%;object-fit:contain}.obsidian-document[data-type=attachment]>:is(audio){width:100%;max-width:min(90%,var(--line-width))}.obsidian-document[data-type=attachment]>:is(embed,iframe,video){width:100%;height:100%;max-width:100%;max-height:100%;object-fit:contain}.canvas-wrapper>:is(.header,.footer){z-index:100;position:absolute;display:flex;justify-content:center;flex-direction:column;width:100%;align-items:center}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){let e=document.querySelectorAll("link[itemprop='include']");for(const t of e){let e=t.getAttribute("href");try{let o="";if(e.startsWith("https:")||e.startsWith("http:")||"file:"!=window.location.protocol){const n=await fetch(e);if(!n.ok){console.log("Could not include file: "+e),t?.remove();continue}o=await n.text()}else{const t=document.getElementById(btoa(encodeURI(e)));if(t){const e=JSON.parse(decodeURI(atob(t.getAttribute("value")??"")));o=e?.data??""}}let n=document.createRange().createContextualFragment(o);t.before(n),t.remove(),console.log("Included text: "+o),console.log("Included file: "+e)}catch(o){t?.remove(),console.log("Could not include file: "+e,o);continue}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script")));!function e(n){let l=o[n],c=n+1;l?(l&&"true"!=l.getAttribute("loaded")||n<o.length&&e(c),n<o.length&&l.addEventListener("load",(()=>e(c)))):n<o.length?e(c):t()}(0)}</script></head><body class="publish css-settings-manager styled-scrollbars show-inline-title show-ribbon is-focused"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="parsed-feature-container" style="display: contents;"><link itemprop="include" href="site-lib/html/custom-head-content-content.html"></div><div id="main"><div id="navbar"></div><div id="main-horizontal"><div id="left-content" class="leaf" style="--sidebar-width: var(--sidebar-width-left);"><div id="left-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><div id="search-container"><div id="search-wrapper"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div aria-label="Clear search" id="search-clear-button"></div></div></div></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="left-sidebar-content" class="leaf-content"><link itemprop="include" href="site-lib/html/file-tree-content.html"></div></div><script defer="">let ls = document.querySelector("#left-sidebar"); ls.classList.toggle("is-collapsed", window.innerWidth < 768); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div></div><div id="center-content" class="leaf"><div class="obsidian-document markdown-preview-view markdown-rendered node-insert-event is-readable-line-width allow-fold-headings allow-fold-lists show-indentation-guide show-properties" data-type="markdown"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><div class="header"><h1 class="page-title heading inline-title" id="Zig_0">Zig</h1><div class="data-bar"></div></div><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="el-p"><p dir="auto">If you take a look at the source code for this project, you may notice that there is not a single line of C present. For a project of this type, that's an unusual occurrence. C is <em>the</em> standard language for low-level and embedded programming. C also has some of the best support for cross compilation out there. Since this project aims to share parts of the codebase between the desktop simulator and the embedded microcontroller, this should be all the more reason to use C.</p></div><div class="el-p"><p dir="auto">Instead, you will find that this project is written in <a data-tooltip-position="top" aria-label="https://ziglang.org/" rel="noopener nofollow" class="external-link is-unresolved" href="https://ziglang.org/" target="_self">Zig</a>. The creator of this language, Andrew Kelly, <a data-tooltip-position="top" aria-label="https://andrewkelley.me/post/zig-cc-powerful-drop-in-replacement-gcc-clang.html" rel="noopener nofollow" class="external-link is-unresolved" href="https://andrewkelley.me/post/zig-cc-powerful-drop-in-replacement-gcc-clang.html" target="_self">wants it to be a replacement for C</a>, especially in the areas mentioned previously. I think that Zig is on the right track to reach that goal from what I've seen. I want to go over some of my favorite features of Zig that have led me to try it out and use it in this project.</p></div><div class="el-h1"><h1 data-heading="Comptime" dir="auto" class="heading" id="Comptime_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Comptime</h1></div><div class="el-p"><p dir="auto">The C macro system is a very clever way to enable changing code at compile time. Through a series of what are essentially string replacements, a C codebase can be reconfigured with just a few flags at compile time. However, it seems that we can do a lot better than glorified search-and-replace. From what I've heard from others and the little that I have personally seen, dealing with C codebases that use extensive amounts of macros in "hacky" ways is awful.</p></div><div class="el-p"><p dir="auto">A related but very different concept is the idea of running code at compile time. I first learned about this concept from <a data-tooltip-position="top" aria-label="https://github.com/BSVino/JaiPrimer/blob/master/JaiPrimer.md" rel="noopener nofollow" class="external-link is-unresolved" href="https://github.com/BSVino/JaiPrimer/blob/master/JaiPrimer.md" target="_self">a description of the unreleased Jai language</a>. This seems incredible at first, but there is really nothing special going on. We already have the ability to compile and run programs. Why not do that recursively? One of my favorite uses for systems like this is creating look-up tables. This way the code to generate the table can stay in the same program (as opposed to having something like a Python script to generate it) while being readable (as opposed to pasting the table into the source file with no explanation).</p></div><div class="el-p"><p dir="auto">Here's an example from the program:</p></div><div class="el-pre"><pre class="language-zig"><code data-line="0" class="language-zig is-loaded"><span class="token keyword">const</span> stateTable <span class="token operator">=</span> <span class="token label">table</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> table<span class="token punctuation">:</span> <span class="token class-name"><span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token builtin-type keyword">u8</span></span> <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
    <span class="token builtin">@memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>table<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">..</span><span class="token number">512</span><span class="token punctuation">)</span> <span class="token operator">|</span>i<span class="token operator">|</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> neighborhood <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">&gt;&gt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">&gt;&gt;</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">&gt;&gt;</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">&gt;&gt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            table<span class="token punctuation">[</span>i <span class="token operator">/</span> <span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">|=</span> <span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token builtin">@intFromBool</span><span class="token punctuation">(</span><span class="token punctuation">(</span>neighborhood <span class="token operator">&gt;=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token punctuation">(</span>neighborhood <span class="token operator">&lt;=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token builtin">@as</span><span class="token punctuation">(</span>u3<span class="token punctuation">,</span> i <span class="token operator">&amp;</span> <span class="token number">0x7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            table<span class="token punctuation">[</span>i <span class="token operator">/</span> <span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">|=</span> <span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token builtin">@intFromBool</span><span class="token punctuation">(</span>neighborhood <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token builtin">@as</span><span class="token punctuation">(</span>u3<span class="token punctuation">,</span> i <span class="token operator">&amp;</span> <span class="token number">0x7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">break</span> <span class="token punctuation">:</span><span class="token label">table</span> table<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">This table is used to look up the next state of a cell given the cell's current state and those of its neighbors. I talk more about the lookup table system in <a data-href="11-30-24" href="daily/11-30-24.html" class="internal-link" target="_self" rel="noopener nofollow">11-30-24</a>, but here I want to focus on how I implemented the table using Zig's comptime system. If I was using C, I probably would have written a Python script to compute the table, print it, and manually turn it into a Zig array. This has the disadvantage of looking like a opaque blob to readers and requiring a separate Python script to be included.</p></div><div class="el-p"><p dir="auto">The first thing to notice is that this does not look like a normal array initialization. There is no type provided, nor is there a list of elements to include. What is here is a labeled <a data-tooltip-position="top" aria-label="https://ziglang.org/documentation/master/#Blocks" rel="noopener nofollow" class="external-link is-unresolved" href="https://ziglang.org/documentation/master/#Blocks" target="_self">block</a>. The value of the block will be equal to what is returned using the <code>break</code> keyword. The key part is that this does not happen when the program is run. Rather, the compiler will evaluate the code inside of the block, take the value it outputs, and embed it into the program as if we had initialized <code>stateTable</code> with that value directly.</p></div><div class="el-p"><p dir="auto">The next bonus is that the code in this block, minus the <code>break</code> statement. is perfectly normal runtime Zig code. If you wanted, you could take it and paste it in the <code>main</code> function and it would word just fine.</p></div><div class="el-h1"><h1 data-heading="Types" dir="auto" class="heading" id="Types_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Types</h1></div><div class="el-p"><p dir="auto">One other use of the comptime system that is not used in this project but is used extensively in the standard library is typing. I am a fan of having types in languages; I much prefer using Typescript over Javascript, and I appreciate type annotations in Python code.</p></div><div class="el-p"><p dir="auto">Zig's types follow a simple rule: they only exist at compile time. There is no reflection style type checking of arbitrary values at runtime. If you try to, the compiler will make sure to let you know. But as long as the code you are running stays in compile time, you can do all of the reflection you want. This is actually used one time in the project, albeit in a minor manor.</p></div><div class="el-pre"><pre class="language-zig"><code data-line="0" class="language-zig is-loaded"><span class="token keyword">var</span> row_idx<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">u32</span></span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">comptime</span> <span class="token punctuation">{</span>
    std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span><span class="token function">assert</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token builtin">@typeInfo</span><span class="token punctuation">(</span><span class="token builtin">@TypeOf</span><span class="token punctuation">(</span>row_idx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>int<span class="token punctuation">.</span>bits<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">The variable <code>row_idx</code> is used to simulate row-by-row drawing functionality in the desktop hal while actually only drawing once. As such, the specific type of this number is not terribly important. However, the type of the number must be big enough to hold the number of rows of the board (minus 1). With another use of comptime code, we can make sure that the type satisfies this requiement. Inside the <code>comptime</code> block, we can perform <code>@typeInfo(@TypeOf(row_idx)).int.bits</code>. This gets the type of <code>row_idx</code>, which is used to get a struct containing information about it, and then uses that struct to find the number of bits <code>row_idx</code> holds.</p></div><div class="el-p"><p dir="auto">Another very common use of types is to achieve a system similar to generics in languages like Java. This system relies on two facts:</p></div><div class="el-ol"><ol>
<li data-line="0" dir="auto">Types can be used as parameters for a function</li>
<li data-line="1" dir="auto">New types can be created and returned from a function<br>
The Zig documentation gives <a data-tooltip-position="top" aria-label="https://ziglang.org/documentation/master/#struct" rel="noopener nofollow" class="external-link is-unresolved" href="https://ziglang.org/documentation/master/#struct" target="_self">an example</a> of this (do a search for <code>LinkedList</code>). In this example, the function <code>LinkedList</code> takes in a type at compile time and returns a custom struct type tailored to that data type. This allows one piece of code to be reused for many different types without having to store any type information at runtime.</li>
</ol></div><div class="el-h1"><h1 data-heading="Build System" dir="auto" class="heading" id="Build_System_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Build System</h1></div><div class="el-p"><p dir="auto">When I've taken a look at C in the past, I've been confused by the number of build systems out there. Judging from what I've seen online, this is a common sentiment. This is why I appreciate languages like Rust and Zig that have one very obvious and almost universally utilized way to build projects. With Zig, your entire project's build is controlled from <code>build.zig</code>. Just like comptime, this allows you to use the Zig language itself to help with building your application. </p></div><div class="el-p"><p dir="auto">Zig also has built in dependency management too. While it's not my favorite, it follows the Zig pattern of reusing existing functionality in a clever way. Any dependencies your project needs are listed in <code>build.zig.zon</code>. The <code>zon</code> stands for Zig Object Notation, which is nearly if not exactly the same syntax that Zig uses for <code>struct</code>s. The contents are described in more detail <a data-tooltip-position="top" aria-label="https://github.com/ziglang/zig/blob/master/doc/build.zig.zon.md" rel="noopener nofollow" class="external-link is-unresolved" href="https://github.com/ziglang/zig/blob/master/doc/build.zig.zon.md" target="_self">here</a>, but the core is attaching either a URL and hash or a local path to each dependency. I started off using the first method, but had to switch to the second after I needed to manually make the external libraries I was using build with a newer release of Zig.<br>
A very simple solution that gets the job done.</p></div><div class="el-p"><p dir="auto">Speaking of the Zig switch, Zig's packaging is also very convenient. Before I upgraded to master, I was just using version 0.13.0 provided in Fedora's repos. Here are all the steps I took to switch to a new release of Zig:</p></div><div class="el-ol"><ol>
<li data-line="0" dir="auto">Download the new version as a prebuilt archive from <a rel="noopener nofollow" class="external-link is-unresolved" href="https://ziglang.org/download/" target="_self">https://ziglang.org/download/</a>.</li>
<li data-line="1" dir="auto">Decompress the archive into my project.</li>
<li data-line="2" dir="auto">Switch from using <code>zig</code> to <code>./zig-master/zig</code> to run commands.<br>
That's it. Once I had fixed the very few breaking changes from 0.13.0 to the master branch at the time, everything worked as normal. No convoluted build process, no polluted <code>PATH</code>, everything just works. </li>
</ol></div><div class="el-p"><p dir="auto">The archive from Zig's website for Zig 0.13.0 for x86_64 Linux is 45MiB, and supports building to any supported target on <a data-tooltip-position="top" aria-label="https://ziglang.org/download/0.13.0/release-notes.html#Tier-3-Support" rel="noopener nofollow" class="external-link is-unresolved" href="https://ziglang.org/download/0.13.0/release-notes.html#Tier-3-Support" target="_self">this table</a> (<a data-tooltip-position="top" aria-label="https://ziglang.org/learn/overview/" rel="noopener nofollow" class="external-link is-unresolved" href="https://ziglang.org/learn/overview/" target="_self">more</a>, see "Cross-compiling is a first-class use case"). There is no need to rebuild the compiler or download a special version for obscure architectures. It can pull this off by only shipping with the source code for various libraries it needs and only building them for a target when requested.</p></div><div class="el-p"><p dir="auto">In addition to being able to cross-compile Zig in this manner, an install of Zig can also serve as a fully featured C compiler. This combination of features has led to some people using Zig as a build system for C projects. Raylib, the C graphics library used in this project, actually supports building in this manner.</p></div><div class="el-h1"><h1 data-heading="End" dir="auto" class="heading" id="End_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>End</h1></div><div class="el-p"><p dir="auto">If you want to hear more about these features as well as some others, you should watch <a data-tooltip-position="top" aria-label="https://www.youtube.com/watch?v=Gv2I7qTux7g" rel="noopener nofollow" class="external-link is-unresolved" href="https://www.youtube.com/watch?v=Gv2I7qTux7g" target="_self">this talk</a> given by Andrew Kelly. Even though it is a few years old, all of the points made still hold up today. </p></div><div class="el-p"><p dir="auto">I view Zig as an effort to update C with all of the knowledge gained in computer science and software engineering over the past half a century. I hope that it will one day gain as much traction as C has now. Because of these new features, and its support for the MSP430 architecture, I have chosen it as the language for this project.</p></div><div class="footer"><div class="data-bar"></div></div></div></div></div><div id="right-content" class="leaf" style="--sidebar-width: var(--sidebar-width-right);"><div id="right-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme-toggle-input" id=""><input class="theme-toggle-input" type="checkbox" id="theme-toggle-input"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="right-sidebar-content" class="leaf-content"><div class="graph-view-wrapper"><div class="feature-header"><div class="feature-title">Interactive Graph</div></div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<div class="graph-icon graph-global" role="button" aria-label="Global Graph" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-git-fork"><circle cx="12" cy="18" r="3"></circle><circle cx="6" cy="6" r="3"></circle><circle cx="18" cy="6" r="3"></circle><path d="M18 9v2c0 .6-.4 1-1 1H7c-.6 0-1-.4-1-1V9"></path><path d="M12 12v3"></path></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div id="outline" class=" tree-container"><div class="feature-header"><div class="feature-title">Table Of Contents</div><button class="clickable-icon nav-action-button tree-collapse-all" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-item" data-depth="1"><a class="tree-item-self is-clickable" href="zig.html#Zig_0" data-path="#Zig_0"><div class="tree-item-inner heading-link" heading-name="Zig">Zig</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-item-self is-clickable" href="zig.html#Comptime_0" data-path="#Comptime_0"><div class="tree-item-inner heading-link" heading-name="Comptime">Comptime</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-item-self is-clickable" href="zig.html#Types_0" data-path="#Types_0"><div class="tree-item-inner heading-link" heading-name="Types">Types</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-item-self is-clickable" href="zig.html#Build_System_0" data-path="#Build_System_0"><div class="tree-item-inner heading-link" heading-name="Build System">Build System</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-item-self is-clickable" href="zig.html#End_0" data-path="#End_0"><div class="tree-item-inner heading-link" heading-name="End">End</div></a><div class="tree-item-children"></div></div></div></div></div><script defer="">let rs = document.querySelector("#right-sidebar"); rs.classList.toggle("is-collapsed", window.innerWidth < 768); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></div></div></body></html>